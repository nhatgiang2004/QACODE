<script>
function fetchData() {
  const url = 'https://docs.google.com/spreadsheets/d/16b_vb7G_4I-EmcWlzFIljJhmTWmiU9eybM126pMKNP0/gviz/tq?sheet=HIENTHI1';
  fetch(url)
    .then(res => res.text())
    .then(rep => {
      const json = JSON.parse(rep.substring(47, rep.length - 2));
      renderTable(json.table);
    })
    .catch(err => {
      document.getElementById('table').innerHTML = "❌ Lỗi tải dữ liệu";
    });
}

function renderTable(table) {
  if (!table.rows || table.rows.length < 3) return;

  let html = '<table><tr>';
  html += '<td class="logo" rowspan="2">' +
          '<img src="https://i.ibb.co/XwPyvS5/1-Logo-100358.jpg">' +
          '</td>';

  // Dòng 1
  table.rows[0].c.slice(1).forEach((cell, i) => {
    let cls = (i === 0) ? "col2" : (i === 1) ? "col3" : "col4";
    html += `<td class="${cls}">${cell && cell.v ? cell.v : ""}</td>`;
  });
  html += '</tr><tr>';

  // Dòng 2
  table.rows[1].c.slice(1).forEach((cell, i) => {
    let cls = (i === 0) ? "col2" : (i === 1) ? "col3" : "col4";
    html += `<td class="${cls}">${cell && cell.v ? cell.v : ""}</td>`;
  });
  html += '</tr>';

  // Dòng 3 – chỉ lấy 2 cột đầu
  html += '<tr class="row3">';
  table.rows[2].c.slice(1,3).forEach((cell,i)=>{
    html += `<td>${cell && cell.v ? cell.v : ""}</td>`;
  });
  html += '</tr></table>';

  document.getElementById('table').innerHTML = html;
}

fetchData();
setInterval(fetchData, 5000);
</script>
