<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Kết quả thi đấu Pickleball</title>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@600&display=swap" rel="stylesheet">
  <style>
    body {margin:0;padding:0;background:#f5f5f5;font-family:'Lexend',sans-serif;text-align:center;}
    .wrapper {
      width:100%;max-width:1000px;margin:10px auto;border-radius:20px;
      background:#fff;overflow:hidden;box-shadow:0 4px 10px rgba(0,0,0,0.25);
      position:relative;
    }
    .vong {background:#28A745;color:#fff;font-size:28px;padding:10px 0;text-transform:uppercase;}
    .giai {background:#555;color:#fff;font-size:24px;padding:8px 0;text-transform:uppercase;}
    .match {
      display:grid;grid-template-columns:80px 1fr 100px 1fr 80px;
      align-items:center;gap:10px;padding:15px 20px;background:white;position:relative;
    }
    .logo {width:70px;height:70px;border-radius:50%;object-fit:cover;}
    .score {font-size:60px;color:#A80000;font-weight:700;}
    .team {color:#FF8C00;font-size:28px;text-transform:uppercase;font-weight:700;}
    .vs {font-size:36px;font-weight:900;color:#FFB400;text-shadow:1px 1px 0 #000;}
    .circle {
      width:30px;height:30px;border-radius:50%;background:red;border:3px solid #000;
      position:absolute;top:50%;transform:translateY(-50%);display:none;
    }
    .circle.left {left:10px;}
    .circle.right {right:10px;}
    @media(max-width:600px){
      .score{font-size:38px}.team{font-size:18px}.vs{font-size:24px}
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="vong" id="vong">Đang tải vòng...</div>
    <div class="giai" id="giai">Đang tải giải...</div>
    <div class="match">
      <div class="score" id="score1">0</div>
      <div class="team" id="team1">---</div>
      <div class="vs">VS</div>
      <div class="team" id="team2">---</div>
      <div class="score" id="score2">0</div>
      <div class="circle left" id="circle1"></div>
      <div class="circle right" id="circle2"></div>
    </div>
  </div>

  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/17l3xrP5q_5miTrFEsp5VFU880oS9Kx6lOe2qfSEBwQQ/gviz/tq?sheet=HIENTHI1";

    function parseGvizData(text) {
      const json = JSON.parse(text.substr(47).slice(0, -2));
      return json.table.rows;
    }

    async function fetchData() {
      try {
        const res = await fetch(sheetURL);
        const text = await res.text();
        const rows = parseGvizData(text);

        // Lấy dữ liệu theo cấu trúc ảnh bạn gửi
        const vong = rows[0]?.c[2]?.v || "ĐANG CẬP NHẬT";
        const giai = rows[1]?.c[2]?.v || "";
        const score1 = rows[2]?.c[1]?.v || "0";
        const team1  = rows[2]?.c[2]?.v || "";
        const team2  = rows[2]?.c[4]?.v || "";
        const score2 = rows[2]?.c[5]?.v || "0";

        document.getElementById("vong").innerText = vong;
        document.getElementById("giai").innerText = giai;
        document.getElementById("score1").innerText = score1;
        document.getElementById("team1").innerText = team1;
        document.getElementById("team2").innerText = team2;
        document.getElementById("score2").innerText = score2;

        // Xác định đội thắng
        const c1 = document.getElementById("circle1");
        const c2 = document.getElementById("circle2");
        c1.style.display = c2.style.display = "none";
        if (Number(score1) > Number(score2)) c1.style.display = "block";
        else if (Number(score2) > Number(score1)) c2.style.display = "block";
      } catch (e) {
        console.error("Lỗi khi tải dữ liệu:", e);
      }
    }

    fetchData();
    setInterval(fetchData, 5000);
  </script>
</body>
</html>
