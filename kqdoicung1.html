<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>K·∫øt qu·∫£ thi ƒë·∫•u</title>
<style>
  body {
    font-family: 'Lexend', sans-serif;
    text-align: center;
    background: white;
    margin: 0;
  }
  .header {
    background: #28a745;
    color: white;
    padding: 10px;
    font-weight: bold;
  }
  .subheader {
    background: #555;
    color: white;
    padding: 8px;
    font-weight: bold;
  }
  table {
    width: 100%;
    margin-top: 20px;
    font-size: 28px;
  }
  td {
    padding: 10px;
  }
  .score {
    color: darkred;
    font-weight: bold;
  }
  .serve {
    color: red;
    font-size: 24px;
  }
  .team {
    font-weight: bold;
    color: orange;
  }
</style>
</head>
<body>
  <div id="round" class="header"></div>
  <div id="tournament" class="subheader"></div>

  <table id="matchTable"></table>

<script>
const sheetUrl = "https://docs.google.com/spreadsheets/d/17l3xrP5q_5miTrFEsp5VFU880oS9Kx6lOe2qfSEBwQQ/gviz/tq?sheet=HIENTHI1";

fetch(sheetUrl)
  .then(res => res.text())
  .then(text => {
    const json = JSON.parse(text.substring(47).slice(0, -2));
    const rows = json.table.rows;

    if (rows.length < 3) {
      document.getElementById("round").innerText = "L·ªñI D·ªÆ LI·ªÜU";
      document.getElementById("tournament").innerText = "KH√îNG ƒê·ª¶ D·ªÆ LI·ªÜU (ph·∫£i c√≥ √≠t nh·∫•t 3 d√≤ng)";
      return;
    }

    // D√≤ng 1 c·ªôt C = v√≤ng lo·∫°i
    document.getElementById("round").innerText = rows[0].c[2]?.v || "Kh√¥ng c√≥ t√™n v√≤ng lo·∫°i";

    // D√≤ng 2 c·ªôt C = t√™n gi·∫£i ƒë·∫•u
    document.getElementById("tournament").innerText = rows[1].c[2]?.v || "Kh√¥ng c√≥ t√™n gi·∫£i ƒë·∫•u";

    // D√≤ng 3 tr·ªü ƒëi = d·ªØ li·ªáu tr·∫≠n
    const matchData = rows.slice(2);

    let html = "";
    matchData.forEach(row => {
      const teamA = row.c[0]?.v || "---";
      const scoreA = row.c[1]?.v ?? 0;
      const serveA = row.c[2]?.v === "A" ? "üî¥" : "";
      const teamB = row.c[3]?.v || "---";
      const scoreB = row.c[4]?.v ?? 0;
      const serveB = row.c[2]?.v === "B" ? "üî¥" : "";

      html += `
        <tr>
          <td class="score">${scoreA}</td>
          <td class="serve">${serveA}</td>
          <td class="team">${teamA}</td>
          <td>VS</td>
          <td class="team">${teamB}</td>
          <td class="serve">${serveB}</td>
          <td class="score">${scoreB}</td>
        </tr>`;
    });

    document.getElementById("matchTable").innerHTML = html;
  })
  .catch(err => {
    document.getElementById("round").innerText = "L·ªñI K·∫æT N·ªêI";
    document.getElementById("tournament").innerText = err.message;
  });
</script>
</body>
</html>
