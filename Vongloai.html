<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Hiển thị Google Sheet</title>
  <style>
    table, th, td {
      border: 1px solid #333;
      border-collapse: collapse;
      padding: 4px;
    }
  </style>
</head>
<body>
  <h1>Dữ liệu từ Google Sheets</h1>
  <table id="sheetTable">
    <thead></thead>
    <tbody></tbody>
  </table>

  <script>
    // URL CSV của sheet
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/16b_vb7G_4I-EmcWlzFIljJhmTWmiU9eybM126pMKNP0/export?format=csv&gid=37490152';

    // Hàm parse CSV đơn giản (mỗi dòng tách bằng newline, mỗi cột tách bằng dấu phẩy)
    function parseCSV(text) {
      const rows = text.trim().split('\n');
      return rows.map(row => {
        // Nếu có nội dung chứa dấu phẩy trong ô, nên dùng thư viện CSV chuyên dụng
        return row.split(',');
      });
    }

    fetch(sheetUrl)
      .then(response => {
        if (!response.ok) throw new Error('Network response was not ok');
        return response.text();
      })
      .then(csvText => {
        const data = parseCSV(csvText);
        const thead = document.querySelector('#sheetTable thead');
        const tbody = document.querySelector('#sheetTable tbody');

        if (data.length > 0) {
          // Header (hàng đầu)
          const headerRow = document.createElement('tr');
          data[0].forEach(cell => {
            const th = document.createElement('th');
            th.textContent = cell;
            headerRow.appendChild(th);
          });
          thead.appendChild(headerRow);

          // Các dòng dữ liệu tiếp theo
          for (let i = 1; i < data.length; i++) {
            const tr = document.createElement('tr');
            data[i].forEach(cell => {
              const td = document.createElement('td');
              td.textContent = cell;
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          }
        }
      })
      .catch(error => {
        console.error('Lỗi khi lấy dữ liệu sheet:', error);
      });
  </script>
</body>
</html>
