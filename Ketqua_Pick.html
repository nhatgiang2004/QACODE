<div id="table"></div>

<script>
  function fetchData() {
    const url =
      'https://docs.google.com/spreadsheets/d/16b_vb7G_4I-EmcWlzFIljJhmTWmiU9eybM126pMKNP0/gviz/tq?sheet=HIENTHI';

    fetch(url)
      .then(res => res.text())
      .then(rep => {
        // Cắt bỏ phần thừa để lấy JSON đúng
        const json = JSON.parse(rep.substring(47, rep.length - 2));
        renderTable(json.table);
      })
      .catch(err => {
        document.getElementById('table').innerHTML =
          '❌ Lỗi tải dữ liệu: ' + err;
      });
  }

  function renderTable(table) {
    if (!table.rows || table.rows.length < 2) {
      document.getElementById('table').innerHTML =
        '⚠️ Sheet HIENTHI chưa có đủ 2 dòng dữ liệu.';
      return;
    }

    let html =
      '<table border="1" cellspacing="0" cellpadding="5" style="border-collapse:collapse;text-align:left;">';

    // Logo rowspan=2
    html += '<tr>';
    html +=
      '<td rowspan="2" style="text-align:center;vertical-align:middle;">' +
      '<img src="https://i.ibb.co/XwPyvS5/1-Logo-100358.jpg" style="width:60px;height:auto;">' +
      '</td>';

    // Dòng 1
    table.rows[0].c.slice(1).forEach(cell => {
      html += '<td>' + (cell && cell.v ? cell.v : '') + '</td>';
    });
    html += '</tr>';

    // Dòng 2
    html += '<tr>';
    table.rows[1].c.slice(1).forEach(cell => {
      html += '<td>' + (cell && cell.v ? cell.v : '') + '</td>';
    });
    html += '</tr>';

    html += '</table>';

    document.getElementById('table').innerHTML = html;
  }

  // Load lần đầu + refresh sau 5 giây
  fetchData();
  setInterval(fetchData, 5000);
</script>
