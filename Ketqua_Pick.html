<div id="table"></div>

<!-- Link font Lexend -->
<link href="https://fonts.googleapis.com/css2?family=Lexend&display=swap" rel="stylesheet">

<script>
  function fetchData() {
    const url = 'https://docs.google.com/spreadsheets/d/16b_vb7G_4I-EmcWlzFIljJhmTWmiU9eybM126pMKNP0/gviz/tq?sheet=HIENTHI';

    fetch(url)
      .then(res => res.text())
      .then(rep => {
        const json = JSON.parse(rep.substring(47, rep.length - 2));
        renderTable(json.table);
      })
      .catch(err => {
        document.getElementById('table').innerHTML = "❌ Lỗi tải dữ liệu: " + err;
      });
  }

  function renderTable(table) {
    if (!table.rows || table.rows.length < 2) {
      document.getElementById('table').innerHTML = "⚠️ Sheet HIENTHI chưa có đủ 2 dòng dữ liệu.";
      return;
    }

    let html = `
      <table cellspacing="0" cellpadding="6"
             style="border-collapse:collapse;font-family:Lexend,sans-serif;font-weight:bold;
                    font-size:16px;width:auto;text-align:left;border:1px solid #fff;">
    `;

    // Logo rowspan=2
    html += '<tr>';
    html += '<td rowspan="2" style="text-align:center;vertical-align:middle;width:60px;padding:2px;border:1px solid #fff;">' +
            '<img src="https://i.ibb.co/XwPyvS5/1-Logo-100358.jpg" style="width:70px;height:70px;border-radius:50%;">' +
            '</td>';

    // Dòng 1
    table.rows[0].c.slice(1).forEach((cell, i) => {
      let style = "padding:8px 8px;border:1px solid #fff;";
      if (i === 0) style += "background:#555;color:white;text-transform:uppercase;text-align:left;"; // Cột 2
      if (i === 1) style += "background:#FFD700;color:black;font-size:18px;font-weight:bold;width:45px;text-align:center;"; // Cột 3
      if (i === 2) style += "width:220px;text-align:left;"; // Cột 4
      html += `<td style="${style}">${cell && cell.v ? cell.v : ""}</td>`;
    });
    html += "</tr>";

    // Dòng 2
    html += "<tr>";
    table.rows[1].c.slice(1).forEach((cell, i) => {
      let style = "padding:8px 8px;border:1px solid #fff;";
      if (i === 0) style += "background:#555;color:white;text-transform:uppercase;text-align:left;"; // Cột 2
      if (i === 1) style += "background:#FFD700;color:black;font-size:18px;font-weight:bold;width:45px;text-align:center;"; // Cột 3
      if (i === 2) style += "width:220px;text-align:left;"; // Cột 4
      html += `<td style="${style}">${cell && cell.v ? cell.v : ""}</td>`;
    });
    html += "</tr>";

    html += "</table>";

    document.getElementById('table').innerHTML = html;
  }

  fetchData();
  setInterval(fetchData, 5000);
</script>
