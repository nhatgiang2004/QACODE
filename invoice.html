<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Phiếu tính tiền</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .header { text-align: center; }
    .header img { width: 80px; }
    h2 { text-align: center; margin-top: 10px; }
    .info-section { margin: 10px 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    table, th, td { border: 1px solid black; }
    th, td { padding: 6px; text-align: center; }
    .total { margin-top: 10px; font-weight: bold; }
    .footer { text-align: center; margin-top: 20px; font-style: italic; }
    .qr { text-align: center; margin-top: 15px; }
    .qr img { width: 200px; }
  </style>
</head>
<body>

  <div class="header">
    <img src="https://i.ibb.co/HDGQyJBw/1-Logo-100358.jpg" alt="logo"><br>
    <strong>HUONG DO PICKLEBALL</strong><br>
    118 Lò Chum, P. Hạc Thành, tỉnh Thanh Hóa
  </div>

  <h2>PHIẾU TÍNH TIỀN</h2>

  <div class="info-section">
    <strong>Số giao dịch:</strong> <span id="id"></span><br>
    <strong>Ngày, giờ:</strong> <span id="time"></span><br>
    <strong>Tên Khách hàng:</strong> <span id="tenkh"></span><br>
    <strong>Giờ bắt đầu:</strong> <span id="start"></span><br>
    <strong>Giờ kết thúc:</strong> <span id="end"></span><br>
  </div>

  <table>
    <thead>
      <tr>
        <th>Dịch vụ</th>
        <th>SL</th>
        <th>Đơn giá</th>
        <th>Thành tiền</th>
      </tr>
    </thead>
    <tbody id="items"></tbody>
  </table>

  <div class="total">
    Tổng cộng: <span id="total"></span> đ<br>
    Bằng chữ: <span id="texttotal"></span>
  </div>

  <div class="qr">
    <img id="qr" src="" alt="QR Code">
  </div>

  <div class="footer">
    Quý khách vui lòng giữ lại phiếu tính tiền<br>
    Xin cảm ơn và hẹn gặp lại!<br>
    Cảm ơn khi tiếp nhận phản hồi của quý khách.
  </div>

<script>
  function getParam(name) {
    return new URLSearchParams(window.location.search).get(name) || "";
  }

  document.getElementById("id").textContent = getParam("id");
  document.getElementById("time").textContent = getParam("time");
  document.getElementById("tenkh").textContent = getParam("tenkh");
  document.getElementById("start").textContent = getParam("start");
  document.getElementById("end").textContent = getParam("end");
  document.getElementById("total").textContent = getParam("total");
  document.getElementById("texttotal").textContent = getParam("texttotal");

  // load QR
  let qrLink = getParam("qr");
  if (qrLink) document.getElementById("qr").src = qrLink;

  // parse items: Dịch vụ|SL|Đơn giá;...
  let itemsStr = getParam("items");
  if (itemsStr) {
    let rows = decodeURIComponent(itemsStr).split(";");
    let html = "";
    rows.forEach(r => {
      let [name, qty, price] = r.split("|");
      if (!name) return;
      let total = parseInt(qty) * parseInt(price);
      html += `<tr>
        <td>${name}</td>
        <td>${qty}</td>
        <td>${parseInt(price).toLocaleString()}</td>
        <td>${total.toLocaleString()}</td>
      </tr>`;
    });
    document.getElementById("items").innerHTML = html;
  }
</script>

</body>
</html>
